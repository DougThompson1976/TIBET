<?xml version="1.0"?>
<project name="{{appname}}" default="help" basedir="~app_root/TIBET-INF">

<property name="boot.version" value="20140125"/>

<!--  =============================================================   -->
<!--  TIBET boot_init target                                          -->
<!--  =============================================================   -->
<!--  this block runs during configuration and can alter boot code    -->
<target name="boot_init">
<!-- Any change sets for the booter itself -->
  <tibet_script>
    <![CDATA[
    ]]>
  </tibet_script>
  <echo>tibet.xml boot_init (pre-config) complete.</echo>
</target>

<!--  =============================================================   -->
<!--  TIBET boot_prefix target                                        -->
<!--  =============================================================   -->
<!--  this block loads/runs prior to any other targets you specify    -->
<target name="boot_prefix" if="boot.phaseone">
  <echo>tibet.xml boot_prefix loading complete.</echo>
</target>

<!--  =============================================================   -->
<!--  Standard application targets                                    -->
<!--  =============================================================   -->
<!--  -->
<target name="all" depends="code, docs">
  <tibet_module target="code"/>
  <tibet_module target="docs"/>
</target>
<target name="code" depends="tibet, app">
  <tibet_module target="boot_prefix"/>
  <tibet_module target="tibet"/>
  <tibet_module target="app"/>
  <tibet_module target="boot_suffix"/>
</target>

<target name="docs">
</target>

<target name="help">
</target>

<target name="test">
</target>

<!--  =============================================================   -->
<!--  TIBET configuration                                             -->
<!--  =============================================================   -->
<!--  -->
<target name="tibet" depends="tibet_img, tibet_chg">

  <!-- NOTE these modules are loaded in phase one -->
  <tibet_module target="tibet_img" if="boot.phaseone"/>
  <echo if="boot.phaseone">tibet image-base loading complete.</echo>
  <tibet_module target="tibet_chg" if="boot.phaseone"/>
  <echo if="boot.phaseone">tibet change-set loading complete.</echo>
</target>

<!--  -->
<target name="tibet_img">
  <tibet_module cfg="~lib_cfg/TIBET.xml" target="{boot.image}"/>
</target>

<!--  -->
<target name="tibet_chg">
<!-- Any change sets for the TIBET image (patches etc) -->
  <tibet_script>
    <![CDATA[
    ]]>
  </tibet_script>
</target>

<!--  =============================================================   -->
<!--  App configuration                                               -->
<!--  =============================================================   -->
<!--  -->
<target name="app" depends="app_img, app_chg">

  <!-- NOTE these modules are loaded in phase two -->
  <tibet_module target="app_img" if="boot.phasetwo"/>
  <echo if="boot.phasetwo">app image-base loading complete.</echo>
  <tibet_module target="app_chg" if="boot.phasetwo"/>
  <echo if="boot.phasetwo">app change-set loading complete.</echo>
</target>

<!--
-->
<target name="app_img">
  <tibet_module cfg="~app_cfg/app.xml" target="full"/>
</target>

<target name="app_chg">
  <!--
  Any change sets for the Application image (patches etc)
  -->
  <tibet_script>
    <![CDATA[
    ]]>
  </tibet_script>
</target>

<!--  =============================================================   -->
<!--  TIBET boot_suffix target                                        -->
<!--  =============================================================   -->
<!--  this block runs prior to $$main() but after code has loaded     -->
<target name="boot_suffix" if="boot.phasetwo">
  <echo>tibet.xml boot_suffix loading complete.</echo>
</target>

</project>

