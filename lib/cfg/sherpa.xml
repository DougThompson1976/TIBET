<?xml version="1.0"?>

<package xmlns="http://www.technicalpursuit.com/1999/tibet"
    name="sherpa" default="base" basedir="~ide_root">

<config id="base">

    <script src="./src/Matchers.js"/>

    <script src="./src/TP.sherpa.Element.js"/>

    <script src="./src/TP.tibet.sherpa.js"/>

    <script src="./src/TP.core.Sherpa.js"/>

    <script src="./src/TP.sherpa.ConsoleService.js"/>

    <script src="./src/TP.sherpa.pp.js"/>

    <script src="./src/TP.log.SherpaLayout.js"/>
    <script src="./src/TP.log.SherpaTestLogLayout.js"/>
    <script src="./src/TP.log.SherpaAppender.js"/>
    <script src="./src/TP.log.SherpaTestAppender.js"/>

    <script src="./src/TP.sherpa.menucontent.js"/>
    <script src="./src/TP.sherpa.focusablesidebar.js"/>

    <script src="./src/TP.sherpa.ToolAPI.js"/>

    <script src="./TP.sherpa.about/TP.sherpa.about.js"/>
    <script src="./TP.sherpa.console/TP.sherpa.console.js"/>
    <script src="./TP.sherpa.halo/TP.sherpa.halo.js"/>
    <script src="./TP.sherpa.customTagContextMenuContent/TP.sherpa.customTagContextMenuContent.js"/>
    <script src="./TP.sherpa.hud/TP.sherpa.hud.js"/>
    <script src="./TP.sherpa.world/TP.sherpa.world.js"/>
    <script src="./TP.sherpa.screen/TP.sherpa.screen.js"/>
    <script src="./TP.sherpa.flex/TP.sherpa.flex.js"/>
    <script src="./TP.sherpa.toggle/TP.sherpa.toggle.js"/>
    <script src="./TP.sherpa.tile/TP.sherpa.tile.js"/>
    <script src="./TP.sherpa.domhud/TP.sherpa.domhud.js"/>
    <script src="./TP.sherpa.breadcrumb/TP.sherpa.breadcrumb.js"/>
    <script src="./TP.sherpa.urieditor/TP.sherpa.urieditor.js"/>
    <script src="./TP.sherpa.methodeditor/TP.sherpa.methodeditor.js"/>
    <script src="./TP.sherpa.typedisplay/TP.sherpa.typedisplay.js"/>
    <script src="./TP.sherpa.searcher/TP.sherpa.searcher.js"/>
    <script src="./TP.sherpa.drawer/TP.sherpa.drawer.js"/>
    <script src="./TP.sherpa.thumbnail/TP.sherpa.thumbnail.js"/>
    <script src="./TP.sherpa.workbench/TP.sherpa.workbench.js"/>
    <script src="./TP.sherpa.styleshud/TP.sherpa.styleshud.js"/>
    <script src="./TP.sherpa.bindshud/TP.sherpa.bindshud.js"/>
    <script src="./TP.sherpa.opener/TP.sherpa.opener.js"/>
    <script src="./TP.sherpa.scrollbutton/TP.sherpa.scrollbutton.js"/>
    <script src="./TP.sherpa.splitbox/TP.sherpa.splitbox.js"/>
    <script src="./TP.sherpa.splitbar/TP.sherpa.splitbar.js"/>
    <script src="./TP.sherpa.dispenser/TP.sherpa.dispenser.js"/>
    <script src="./TP.sherpa.dispenseritem/TP.sherpa.dispenseritem.js"/>
    <script src="./TP.sherpa.readout/TP.sherpa.readout.js"/>
    <script src="./TP.sherpa.notifier/TP.sherpa.notifier.js"/>
    <script src="./TP.sherpa.consoleoutput/TP.sherpa.consoleoutput.js"/>
    <script src="./TP.sherpa.contextmenu/TP.sherpa.contextmenu.js"/>
    <script src="./TP.sherpa.respondershud/TP.sherpa.respondershud.js"/>
    <script src="./TP.sherpa.inspector/TP.sherpa.inspector.js"/>
    <script src="./TP.sherpa.inspectoritem/TP.sherpa.inspectoritem.js"/>
    <script src="./TP.sherpa.navlist/TP.sherpa.navlist.js"/>
    <script src="./TP.sherpa.outliner/TP.sherpa.outliner.js"/>
    <script src="./TP.sherpa.changes/TP.sherpa.changes.js"/>
    <script src="./TP.sherpa.count/TP.sherpa.count.js"/>
    <script src="./TP.sherpa.sync/TP.sherpa.sync.js"/>
    <script src="./TP.sherpa.settings/TP.sherpa.settings.js"/>
    <script src="./TP.sherpa.bookmarkMenuContent/TP.sherpa.bookmarkMenuContent.js"/>
    <script src="./TP.sherpa.snippetMenuContent/TP.sherpa.snippetMenuContent.js"/>
    <script src="./TP.sherpa.worldthumbnails/TP.sherpa.worldthumbnails.js"/>
    <script src="./TP.sherpa.toolbar/TP.sherpa.toolbar.js"/>
    <script src="./TP.sherpa.typeToolbarContent/TP.sherpa.typeToolbarContent.js"/>
    <script src="./TP.sherpa.typesToolbarContent/TP.sherpa.typesToolbarContent.js"/>
    <script src="./TP.sherpa.methodsToolbarContent/TP.sherpa.methodsToolbarContent.js"/>
    <script src="./TP.sherpa.uriEditorToolbarContent/TP.sherpa.uriEditorToolbarContent.js"/>
    <script src="./TP.sherpa.methodEditorToolbarContent/TP.sherpa.methodEditorToolbarContent.js"/>
    <script src="./TP.sherpa.elementContextMenuContent/TP.sherpa.elementContextMenuContent.js"/>

    <resource href="~ide_root/xhtml/sherpa_framing.xhtml"/>
    <resource href="~ide_root/xhtml/sherpa_console_templates.xhtml"/>

    <resource href="~ide_root/css/sherpa_pp.css"/>

    <script src="./src/TP.sherpa.CouchTools.js"/>

    <script src="~lib_deps/html2canvas-tpi.min.js"
        if="boot.minified" no-lint="no-lint" no-minify="no-minify"/>
    <script src="~lib_deps/html2canvas-tpi.js"
        unless="boot.minified" no-lint="no-lint" />
    <script>
        <![CDATA[
        TP.extern.html2canvas = window.html2canvas;

        //  We need to install this managed Mutation Observer filter function to
        //  filter out mutations caused by taking a snapshot with HTML2Canvas.

		TP.definePrimitive('$$html2CanvasElementPresentObserverFilter',
        function(aMutationRecord) {

            var targetDoc,
                html2CanvasIFrame;

            targetDoc = TP.nodeGetDocument(aMutationRecord.target);

            html2CanvasIFrame =
                targetDoc.querySelector('.html2canvas-container');
            if (TP.isElement(html2CanvasIFrame)) {
                return false;
            }

            return true;
        });

		TP.definePrimitive('$$html2CanvasElementInsertedOrRemovedObserverFilter',
        function(aMutationRecord) {

            if (aMutationRecord.type === 'attributes' &&
                aMutationRecord.attributeName.startsWith(
                                                    'data-html2canvas')) {
                return false;
            }

            if (TP.notEmpty(aMutationRecord.addedNodes) &&
                TP.isElement(aMutationRecord.addedNodes[0]) &&
                TP.elementHasClass(aMutationRecord.addedNodes[0],
                                    'html2canvas-container')) {
                return false;
            }

            if (TP.notEmpty(aMutationRecord.removedNodes) &&
                TP.isElement(aMutationRecord.removedNodes[0]) &&
                TP.elementHasClass(aMutationRecord.removedNodes[0],
                                    'html2canvas-container')) {
                return false;
            }

            return true;
        });
        ]]>
    </script>

</config>

</package>

